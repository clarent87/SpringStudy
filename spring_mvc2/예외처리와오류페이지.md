# 예외처리와 오류 페이지

## 서블릿 예외처리 - 시작 (3)
  
스프링이 아닌 순수 서블릿 컨테이너는 예외를 어떻게 처리하는지 알아보자
  
- 서블릿은 다음 2가지 방식으로 예외 처리를 지원한다.
  - Exception (예외) 
    - > WAS, 서블릿 컨테이너 까지 예외가 날라갈때. 진짜 exception (ex: nullpointer)
  - response.sendError(HTTP 상태 코드, 오류 메시지)

- **오.. pdf 설명 매우 좋음. 꼭 확인 할것!! 👍**

- was까지 예외가 전달되었을떄
  -  tomcat이 기본으로 제공하는 오류 화면 확인 가능 -> status 500 page  
- `response.sendError(HTTP 상태 코드, 오류 메시지)`
  - 서블릿 컨테이너에게 오류가 발생했음을 전달함

## 서블릿 예외처리 - 오류 화면 제공 (6)

was default 오류페이지를, 그럴싸한것으로 변경하는 작업을 진행  

- 원리
  - 특정 에러,http status 코드 발생시 들어가야할 컨트롤러(uri)를 세팅함 WebServerFactoryCustomizer
  - 따라서 에러발생시 아래와 같이 동작함
    - 컨트롤러(예외) -> 인터셉터(예외) -> 서블릿(예외) -> 필터(예외) -> was(예외) 
    - -> 필터(uri) -> 서블릿(uri)  -> 인터셉터(uri)  -> 컨트롤러(uri) 

## 서블릿 예외처리 - 오류페이지 작동 원리 (10)

- 원리는 PDF에 잘나옴. 근데 위 설명한거랑 동일
- 추가적으로 WAS가 request.attribute에 담아주는 에러 정보를 찍어봄
  - WAS는 오류 페이지를 단순히 다시 요청만 하는 것이 아니라, 오류 정보를 request 의 attribute 에
    추가해서 넘겨준다

## 서블릿 예외처리 - 필터(13)

- 필터든 인터셉터든 예외처리시에는 두번 호출됨
  - 왜냐면 client가 request했을때 필터/인터셉터동작하고 컨트롤러에서 에러 발생해서 WAS로 내려갔을떄
  - WAS에서 등록한 예외처리 컨트롤러 호출하면 다시 필터/인터셉터 타고 가니까..
  - 근데 이거 비효율.. 로그인 같은거 생각해보면 이미 처리되었는데 또 처리할 필요가 없음
  - 또는 두번 호출되면 안되는 필터/인터셉터가 있을수 있음
  - 이런것을 처리하기 위해 DispatcherType을 WAS가 예외정보에 넣어서 올려준다. ( 등록한 예외 컨트롤러 호출할떄)

- FilterRegistrationBean으로 필터 등록시 setDispatcherTypes으로 필터가 동작하기를 원하는 DispatcherType을 지정할수 있음
  - > default는 REQUEST. 즉 원만하면 그냥 둬도 됨. 즉 특별히 오류 페이지 경로도 필터를 적용할 것이 아니면, 기본 값을 그대로 사용하면 된다

## 서블릿 예외처리 - 인터셉터 (17)

## 스프링부트 - 오류페이지 1

## 스프링부트 - 오류페이지 2

## 정리