# 타입리프 스프링 통합과 폼

스프링과 통합되서 돌아가는 기능을 알아봄 
프로젝트는 form 임

- 타임리프 스프링 통합 (2)
  - 타입리프는 메뉴얼을 두개를 제공
    - 기본메뉴얼. 스프링 없이 타입리프만 쓸때. -> 이건 앞의 강좌 내용
    - 스프링통합메뉴얼
  - > 그냥 pdf 참조
  - 원래 타입리프를 쓰려면 이것저것 세팅해야하는데..spring boot 쓰면 알아서 해줌
  - 그래도 세세한 세팅 하고 싶다면 pdf 참저 (어디 보면 되는지 link있음)
    - 근데 사용할 일이 잘 없다고는함. 

- 입력폼 처리 (3)
  - 일단 타입리프의 th:object 를 쓰려면 controller에 model에 empty 객체를 하나 만들어서 넣어서 보내야 한다. 
  - th:field 쓰면 html id , name , value 속성을 자동으로 생성해 주는데. intellj의 인텔리전트를 위해 id는 그래도 만들어둠
    - th:field 는 타입리프가 spring을 위해 제공하는거
    - 적확히는 id field를 삭제하지 않고 그대로 둠
    - id와 name은 `th:field="*{quantity}"` 에서 **넘긴 변수 이름**으로 세팅되고 value는 해당 변수의 값으로 세팅됨
      - 값이 없는경우는 value에 아무값도 들어가지 않음
      - > 변수 이름이 쎄팅되는거 중요 👍
  - 선택 변수 식 
    - `*{}` 예시 보면 이해감. 쉬움
  - > 위 내용만으로는 장점이 없어 보이는데. Validation에서 강점이 나온다고함.. (validation이 내가 원하는 느낌의 것이 아닌가봄..)

- 요구사항 추가 (7)
  - 요구사항에 따라 item에 변수들을 추가함 ( 변수의 type은 enum, class등 다양한 형태로 만들어서 준비)

- 체크 박스 - 단일1 (10)
  - 체크 박스를 체크하면 HTML Form에서 open=on 이라는 값이 넘어간다. 
    - 스프링은 on 이라는 문자를 true 타입으로 변환해준다. (스프링 타입 컨버터가 이 기능을 수행하는데, 뒤에서 설명한다.)
  - HTML에서 체크 박스를 선택하지 않고 폼을 전송하면 open 이라는 필드 자체가 서버로 전송되지 않는다. ( 컨트롤러에서 값찍으면 null 나옴) 
    - > 이게 문제가 되는 케이스가 있음. 만약 사용자가 체크해제를 해도 값이 넘어가지 않기때문에, 해당 값을 수정해야 하는것인지. 아니면 값을 변경하지 말아야하는지 모호.
    - 이 경우를 위한 spring-mvc의 트릭이 있음 -> 히든필드 pdf 참조
      - > 매번 히든필드 쓰기 불편해서 타입리프가 해결해주는 방식이 다음 절의 내용

- 체크 박스 - 단일2 (12)
  - `th:field="*{open}"`
    - 이거 쓰면됨 체크박스인 경우는 히든필드도 생성 해줌
    - 체크 박스의 `checked="checked"`도 자동으로 값에 따라 타입리프가 추가해줌. th:field사용시..  👍
    - diabled는 체크 박스 선택 못하게 막는것

- 체크 박스 - 멀티 (16)
  - `@ModelAttribute` 라는 특별한 기능을 mvc에서 제공함. ( 앞서 배운 그거 아님!!)
    - > 성능에 대한 언급이 잠깐 있음. 코드에 적어둠. 아래 내용이랑 연관됨
    - 이거 컨트롤러의 method 호출될떄마나 호출됨 👍 
  - 멀티 체크 박스를 타입리프로 만들떄 id 자동생성 되는데.. 해당 id를 label에 쓰기 위한 트릭이 있음
    - `th:for="${#ids.prev('regions')}"`
      - `th:field="*{regions}`에서 자동으로 생성되는 regions1, regions2 같은 id를 인식해서 넣어두주는 특별한 구문 (#ids.prev, ids.next 같은게 있음)
        - `#ids` 같은거 메시지 표현식? 이라고 하나봄. 여튼 타입리프 제공 객체는 모두 `#` 로 시작했었음. 타입리프 기본기능에서 나왔음
      - 이때 name의 경우는 regions로 모두 동일 ( each문에서 생성되는 것들 모두.)
      - pdf에 잘 나옴.
    - > 앞서나왔듯 input tag의 id는 lable에서 명시해야한다. ( 그래서 th:field를 써도 id는 걍 뒀음. intellj의 인텔리전스를 위해)
  - 코드 돌려보면 region에 배열로 잘들어 오는것을 알수있음
  - 예시는 sigle check box를 타입리프 foreach로 여러개 만든.. 그런거임. 배열에 알아서 잘 들어오는게 신기
    - `regions=SEOUL&_regions=on&regions=BUSAN&_regions=on&_regions=on`
      - post form은 get과 유사하게 들어오는듯. 원래 이런다고 했던거 같음.
      - 같은 변수 명 regions에 값이 여러개 오기 때문에 배열로 만들어 지는듯. -> 이거 mvc1에서 아주 초기에 이런 개념 나왔었음
      - 즉 id는 다르지만. name은 같은게 생성된것 th:field 때문
    - `item.regions=[SEOUL, BUSAN]`
  - `th:field="${item.regions}"`로 써도 `#ids.prev('regions')`는 먹힘
  - addform.html 예시의 regions 구별 잘해야함. 하나는 item에서 넘어오는거고, 하나는 그냥 model에 추가되어 넘어오는것( ui 용)
  - > 이번 내용은 예시가 살짝 복잡

- 라디오 버튼 (20)
  - 이번엔 enum을 이용해서 ui를 구성하는데 사용
  - 멀티 박스랑 거의 비슷.
  - 라디오 버튼은 히든 필드 이런거 없다. 즉 선택안하면 해당 field의 값은 전달되지 않으므로. mvc에서 null 처리됨
    - > 수정할때 보면 라디오 버튼은 값을 뺄수가 없다. 즉 무조건 값이 넘어감. 그래서 히든 필드 같은게 필요없다고함.. 
    - > 원래 히든필드는 수정 할때 문제가 있는 거였음. ( 값이 없는게 값이 변한건지, 아니면 값이 변하지 않았다고 처리해야하는지.. 모호성이 있었음)
  - 역시 check된거 판단해서 checked html 구문은 넣어준다. 
  - 타입리프에서는 springEL 문법으로 enum에 직접 접근 가능
    - 이거 이용하면 enum을 굳이 model에 넘기지 않아도 되지만.. 이걸 권장하지는 않는다. pdf에 잘 나와 있음.
- 셀렉트 박스 (24)
  - selected도 알아서 타입리프가 넣어줌
  - 여기는 앞 내용들이랑 큰 차이가 없음
  
- 정리
  - 빈선택및 메소드 호출가능한데.. 예시로는 잘 안쓴듯.