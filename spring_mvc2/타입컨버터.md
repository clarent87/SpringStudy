# íƒ€ì…ì»¨ë²„í„°

## ìŠ¤í”„ë§ íƒ€ì… ì»¨ë²„í„° ì†Œê°œ (3)

- 4p ì˜ˆ ì˜ˆì‹œ ì˜¤íƒ€

```java
/users/{userId}
@PathVariable("userId") Integer data // ì˜¤íƒ€ ìˆ˜ì •

```

## íƒ€ì… ì»¨ë²„í„° - Converter (6)

íƒ€ì… ì»¨ë²„í„° ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„í•˜ê³ , ì§ì ‘ ì‚¬ìš©(test code)í•´ë³´ëŠ” ê²ƒ ê¹Œì§€ ì§„í–‰ ( ì•„ì§ ì»¨ë²„í„° ë“±ë¡í•˜ëŠ”ê²ƒì€ ì•ˆí•¨ )

> TODO ì˜ë¬¸.  
> ì•„ê·œë¨¼íŠ¸ ë¦¬ì¡¸ë²„ë‘ ì°¨ì´ê°€ ìˆë‚˜?  
> ì˜ˆì™¸ëŠ” ì–´ë–»ê²Œ ì²˜ë¦¬?

- ìŠ¤í”„ë§ì€ ìš©ë„ì— ë”°ë¼ ë‹¤ì–‘í•œ ì»¨ë²„í„° ì œê³µ (11p)
  > ìì„¸í•œ ë‚´ìš©ì€ spring ë§¤ë‰´ì–¼ ì°¸ì¡° í•´ì•¼í•¨. ë‚˜ì¤‘ì— ê¼­ í™•ì¸í•´ ë³¼ê²ƒ!!
  - Converter ê¸°ë³¸ íƒ€ì… ì»¨ë²„í„° (ê¸°ë³¸ì ìœ¼ë¡œ ì´ê²ƒë§Œ ì•Œë©´ë¨)
  - ConverterFactory ì „ì²´ í´ë˜ìŠ¤ ê³„ì¸µ êµ¬ì¡°ê°€ í•„ìš”í•  ë•Œ
  - GenericConverter ì •êµí•œ êµ¬í˜„, ëŒ€ìƒ í•„ë“œì˜ ì• ë…¸í…Œì´ì…˜ ì •ë³´ ì‚¬ìš© ê°€ëŠ¥
  - ConditionalGenericConverter íŠ¹ì • ì¡°ê±´ì´ ì°¸ì¸ ê²½ìš°ì—ë§Œ ì‹¤í–‰
  - > ì •êµí•œ ì»¨ë²„í„°ê°€ í•„ìš”í•˜ë©´ ìœ„ ë‚´ìš©ë“¤ì„ ë©”ë‰´ì–¼ ë³´ê³  êµ¬í˜„í•˜ë©´ë¨

## ì»¨ë²„ì „ ì„œë¹„ìŠ¤ - Conversion Service (11)

conversionServiceì— ì»¨ë²„í„° ë§Œë“ ê±° ë“±ë¡í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒ ë‚˜ì˜´

```java
// ì¼ë‹¨ ì„œë¹„ìŠ¤ì— ì»¨ë²„í„° ë“±ë¡
// ì‹¤ì œ ì‚¬ìš©ì‹œ ë“±ë¡ ë¶€ë¶„ì€ ë”°ë¡œ configurationì—ì„œ bean ë“±ë¡ì„ í•´ì„œ ì¨ì•¼í•œë‹¤.
DefaultConversionService conversionService = new DefaultConversionService(); // ConversionService êµ¬í˜„ì²´
conversionService.addConverter(new StringToIntegerConverter());
// ì‚¬ìš©ì€ ì•„ë˜ ì²˜ëŸ¼ í•¨
IpPort ipPort = conversionService.convert("127.0.0.1:8080", IpPort.class); // ì¦‰ sourceë¥¼ ë„£ê³ , ë°˜í™˜ìœ¼ë¡œ ì›í•˜ëŠ” typeì„ ëª…ì‹œí•´ì¤Œ
                                                                            // ì´ëŸ¬ë©´ ì•Œì•„ì„œ ì„œë¹„ìŠ¤ì—ì„œ ë§ëŠ” ì»¨ë²„í„° ì°¾ì•„ì„œ ì ìš©
```

- ISP ì†Œê°œê°€ ë‚˜ì˜´
  - DefaultConversionService ê°™ì€ê²½ìš° ConversionService, ConverterRegistry ë‘ê°€ì§€ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ê³  ìˆìœ¼ë¯€ë¡œ
  - ì‚¬ìš©í•˜ëŠ” ì¸¡ì—ì„œëŠ” `ConversionService service = new DefaultConversionService()`ë¡œ ë°›ì•„ì„œ ì“¸ìˆ˜ ìˆìŒ
    - ( ë¬¼ë¡ , ë¹ˆ ì£¼ì…ì„ ë°›ì•„ì•¼ DefaultConversionService ì˜ì¡´ì´ ì—†ì–´ì§)
    - > TODO: ë¹ˆ ì£¼ì… interface ì£¼ì…ì€ ë”°ë¡œ ì•Œì•„ë´„
  - ì¦‰ ì‚¬ìš©í•˜ëŠ” ì¸¡ì€ ConversionServiceë§Œ ì˜ì¡´í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥
    - > ê´€ë ¨ ë‚´ìš©ì€ UMLì— ìˆìŒ
  - ì´ëŸ°ê²ƒ ì²˜ëŸ¼ springì—ì„œëŠ” ê°ì²´ ì§€í–¥ solid ì›ì¹™ì´ ì˜ ë“¤ì–´ê°€ ìˆë‹¤.
    - ex: ì‚¬ìš©í•˜ëŠ” ìª½, ë“±ë¡í•˜ëŠ” ìª½ ì¸í„°í˜ì´ìŠ¤ê°€ ì´ëŸ°ì‹ìœ¼ë¡œ ì˜ ë¶„ë¦¬ëœ ì¼€ì´ìŠ¤ê°€ ë§ë‹¤.

## ìŠ¤í”„ë§ì— Converter ì ìš©í•˜ê¸° (14)

- webConfigì—ì„œ adaddFormatter ë©”ì†Œë“œë¥¼ í™œìš©í•œê²Œ íŠ¹ì´í•¨ ğŸ‘

- @ModelAttributeì—ë„ ì˜ ì ìš©ëœë‹¤ê³  í•¨
  - > ì•„ë§ˆ ì´ê²½ìš°ëŠ” ModelAttribute ì ìš©ë˜ëŠ” param íƒ€ì…ì˜ fieldì— ì ìš©ëœë‹¤ëŠ” ê²ƒì´ê² ì§€..
  - > ì¦‰ ì¿¼ë¦¬ param ì—¬ëŸ¬ê°œ(string ì„)ì„ ê°ì²´ì— ë§¤í•‘í• ë•Œ ê°ì²´ fieldì˜ typeì„ ë³´ê³  íƒ€ì… ì»¨ë²„í„° ë™ì‘
  - > ~~ê·¸ëŸ¼ @RequestBodyì—ë„ ì˜ ë™ì‘í• ê±° ê°™ìŒ~~ --> ì •ë¦¬ ì ˆì—ì„œ ì•„ë‹ˆë¼ê³  ëª»ë°•ìŒ

- @RequestParam ì€ @RequestParam ì„ ì²˜ë¦¬í•˜ëŠ” ArgumentResolver ì¸ RequestParamMethodArgumentResolver ì—ì„œ
  ConversionService ë¥¼ ì‚¬ìš©í•´ì„œ íƒ€ì…ì„ ë³€í™˜í•œë‹¤ ğŸ‘

- ì˜ë¬¸
  - @RequestBodyì—ì„œ jsonë¥¼ ê°ì²´ì— ë§¤í•‘ í•´ì£¼ë˜ë°. httpë©”ì‹œì§€ì»¨ë²„í„°ì— ì˜í•œ ë™ì‘.
  - ê·¸ëŸ¼ ë©”ì‹œì§€ ì»¨ë²„í„°ë‘ íƒ€ì… ì»¨ë²„í„°ëŠ” ë‹¤ë¥¸ê±´ê°€?? -> ë‹¤ë¥¸ê±° ê°™ìŒ
  - í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° -> argument Resolver ( return value handler)
    - argument Resolverì—ì„œ ê°ì¢… ì–´ë…¸í…Œì´ì…˜ ì²˜ë¦¬í•¨  ( return value handler)
    - ì´ë–„ @RequestBody, HttpEntity ì¸ parmì— ëŒ€í•´ì„œëŠ” httpë©”ì‹œì§€ ì»¨ë²„í„°ê°€ ë™ì‘
    - @RequestParamì˜ ê²½ìš° íƒ€ì… ì»¨ë²„í„° ë™ì‘ => ì´ë¶€ë¶„ì€ í˜„ì¬ ì˜ˆì œë¥¼ ë³´ê³  ì¶”ë¡ 
  - > ì¦‰ ë©”ì‹œì§€ ì»¨ë²„í„°ì™€ íƒ€ì… ì»¨ë²„í„°ëŠ” ë‹¤ë¥¸ ê²ƒì´ë‹¤. ( ë©”ì‹œì§€ ì»¨ë²„í„°ëŠ” interfaceê°€ íƒ€ì… ì»¨ë²„í„°ë‘ì€ ë‹¤ë¦„)

- tip
  - ìŠ¤í”„ë§ ì½”ë“œ ë¶„ì„í• ë• debug pointê±¸ì–´ì„œ stacktraceë¥¼ ë³´ë©´ì„œ ë¶„ì„í•˜ëŠ”ê²Œ ì¢‹ë‹¤. ( ì¶”ìƒí™”ê°€ ì˜ ë˜ì–´ ìˆì–´ì„œ ê·¸ëƒ¥ ì†ŒìŠ¤ ë³´ê¸° ì–´ë ¤ì›€)
  - ex: íƒ€ì… ì»¨ë²„í„° ë§Œë“ ê±°ì— bread pointê±¸ê³  ë””ë²„ê¹…. ê·¸ëŸ¼ ë“±ë¡í•œ íƒ€ì… ì»¨ë²„í„° í˜¸ì¶œ ì‹œì ì— break ê±¸ë¦¼. 
  - ì—¬ê¸°ì„œ ë¶€í„° stackì„ ë´ì„œ ì–´ë–¤ ì–´ë–¤ methodë¥¼ íƒ€ê³  ì™”ëŠ”ì§€ ì•Œìˆ˜ ìˆìŒ

## ë·° í…œí”Œë¦¿ì— Converter ì ìš©í•˜ê¸° (16)

- `"${{number}}"` ì²˜ëŸ¼ `{` ë¥¼ ë‘ê°œë¥¼ ì“°ë©´ íƒ€ì… ì»¨ë²„í„°ê°€ ì ìš©ë¨

```html
<ul>
    <!--  ì‚¬ì‹¤ ìˆ«ìì •ë„ëŠ” ì»¨ë²„í„°ê°€ ì—†ì–´ì„œ íƒ€ì…ë¦¬í”„ê°€ ì²˜ë¦¬ í•´ì¤€ë‹¤.-->
    <li>${number}: <span th:text="${number}"></span></li>
    <!-- numberëŠ” ìˆ«ìì¸ë° textë¡œ ì¶œë ¥í•˜ê¸° ìœ„í•´ íƒ€ì… ì»¨ë²„í„°ë¥¼  ì ìš©-->
    <li>${{number}}: <span th:text="${{number}}"></span></li> 
    <li>${ipPort}: <span th:text="${ipPort}"></span></li>
    <li>${{ipPort}}: <span th:text="${{ipPort}}"></span></li>
</ul>

```

- í¼ì—ëŠ” ì»¨ë²„í„°ê°€ ìë™ìœ¼ë¡œ ì ìš© ë¨
  - `th:field` ì—ë§Œ ìë™ ì ìš© -> ì½”ë“œ ì˜ˆì‹œ ì°¸ì¡°
  - > `th:value` ëŠ” íƒ€ì…ë¦¬í”„ ìŠ¤í”„ë§ í†µí•© ê¸°ëŠ¥ì€ ì•„ë‹Œê°€ë´„

- @ModelAttribute ì—ë„ ìë™ìœ¼ë¡œ ì»¨ë²„í„°ê°€ ì ìš©ë¨

## í¬ë§·í„° - Formatter (21)

- ì¼ë°˜ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ í™˜ê²½ì„ ìƒê°í•´ë³´ì. ë¶ˆë¦° íƒ€ì…ì„ ìˆ«ìë¡œ ë°”ê¾¸ëŠ” ê²ƒ ê°™ì€ ë²”ìš© ê¸°ëŠ¥ ë³´ë‹¤ëŠ” ê°œë°œì ì…ì¥ì—ì„œëŠ”
  ë¬¸ìë¥¼ ë‹¤ë¥¸ íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ê±°ë‚˜, ë‹¤ë¥¸ íƒ€ì…ì„ ë¬¸ìë¡œ ë³€í™˜í•˜ëŠ” ìƒí™©ì´ ëŒ€ë¶€ë¶„
  - ì»¨ë²„í„°ëŠ” ë§¤ìš° ë²”ìš©ì ì´ì—ˆìŒ

- í¬ë§¤í„°ëŠ” ë¬¸ìì— íŠ¹í™”ë¨

- ì˜ˆì œ : ìˆ«ì 1000 ì„ ë¬¸ì "1,000" ìœ¼ë¡œ ê·¸ëŸ¬ë‹ˆê¹Œ, 1000 ë‹¨ìœ„ë¡œ ì‰¼í‘œê°€ ë“¤ì–´ê°€ëŠ” í¬ë§·ì„ ì ìš©í•´ë³´ì. ê·¸ë¦¬ê³  ê·¸ ë°˜ëŒ€ë„ ì²˜ë¦¬í•´ì£¼ëŠ” í¬ë§·í„°ë¥¼ ë§Œë“¤ì–´ë³´ì

- ìŠ¤í”„ë§ì€ ìš©ë„ì— ë‹¤ì–‘í•œ ë°©ì‹ì˜ í¬ë§¤í„°ë¥¼ ì œê³µí•¨
  - AnnotationFormatterFactory : ì–´ë…¸í…Œì´ì…˜ ì •ë³´ë¥¼ ì´ìš©í• ìˆ˜ ìˆëŠ” í¬ë§·í„°ì¸ë° ë³µì¡í•˜ë‹¤ê³ í•¨ pdfì°¸ì¡°

## í¬ë§·í„°ë¥¼ ì§€ì›í•˜ëŠ” ì»¨ë²„ì „ ì„œë¹„ìŠ¤ (25)

- Test ì½”ë“œì— DefaultFormattingConversionService ë¥¼ ì´ìš©í•´ì„œ ë§Œë“  í¬ë§¤í„°ë¥¼ í…ŒìŠ¤íŠ¸
  - ì»¨ë²„í„° ì„œë¹„ìŠ¤ DefaultConversionService ì—ëŠ” í¬ë§¤í„°ë¥¼ ë“±ë¡í• ìˆ˜ëŠ” ì—†ë‹¤. 
  - ê·¸ë˜ì„œ í¬ë§·í„°ë¥¼ ì§€ì›í•˜ëŠ” ì»¨ë²„ì „ ì„œë¹„ìŠ¤ ì¸ FormattingConversionService ë¥¼ ì‚¬ìš©í•´ì•¼í•˜ëŠ”ë° 
  - ì´ê²ƒë³´ë‹¤ ê¸°ëŠ¥ì´ ì¢€ë” ìˆëŠ” DefaultFormattingConversionService ë¥¼ ì‚¬ìš©í•¨


- ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” DefaultFormattingConversionService ë¥¼ ìƒì† ë°›ì€ WebConversionService ë¥¼ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•œë‹¤.
  - > ì»¨ë²„í„° ë“±ë¡ì‹œ WebMvcConfigurer ì˜ addFormatters ë¥¼ ì‚¬ìš©í•œ ì´ìœ  ì¸ê°€ë´„.

## í¬ë§·í„° ì ìš©í•˜ê¸° (26)

- webConfigì— ì¶”ê°€í•˜ëŠ” ë°©ì‹
  - ì£¼ì˜ ì ì€ ì»¨ë²„í„°ë‘ í¬ë§¤í„°ì˜ ìš°ì„ ìˆœìœ„ì¸ë°, ì»¨ë²„í„° ì ìš©ì´ ë” ë¹ ë¦„ ( ì¦‰ ì»¨ë²„í„°ê°€ ì ìš©ë˜ë©´ í¬ë§¤í„°ëŠ” ì ìš©ì•ˆë¨)
  - ì˜ˆë¥¼ë“¤ì–´ String -> Integer í•˜ëŠ” ì»¨ë²„í„°, í¬ë§¤í„°ê°€ ë“±ë¡ë˜ì–´ ìˆë‹¤ë©´ ì»¨ë²„í„°ê°€ ë” ë¹ ë¥´ê²Œ ì ìš©ëœë‹¤ëŠ”ê²ƒ

- ë·°í…œí”Œë¦¿ì—ë„ ì˜ë¨¹í˜.

## ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ë³¸ í¬ë§·í„° (28)

- ê·¸ëŸ°ë° í¬ë§·í„°ëŠ” ê¸°ë³¸ í˜•ì‹ì´ ì§€ì •ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, ê°ì²´ì˜ ê° í•„ë“œë§ˆë‹¤ ë‹¤ë¥¸ í˜•ì‹ìœ¼ë¡œ í¬ë§·ì„ ì§€ì •í•˜ê¸°ëŠ” ì–´ë µë‹¤.
  - > ì´ë§ì€ Integer -> String í¬ë§·í„° ë“±ë¡í•˜ë©´ í•´ë‹¹ íƒ€ì…ì˜ ëª¨ë“  fieldëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ê·¸ê²ƒë§Œ ì ìš©ëœë‹¤ëŠ” ë§ê°™ìŒ. 
  - >ìŠ¤í”„ë§ì€ ì´ê±¸ í•´ê²°í•´ì£¼ëŠ” ì–´ë…¸í…Œì´ì…˜ ê¸°ë°˜ í¬ë§¤í„°ë¥¼ ì œê³µ

- th:fieldëŠ” ì»¨ë²„í„°ê°€ ìë™ ì ìš©ë¨. th:fieldì•„ë‹Œê³³ì€ {{}} ì²˜ëŸ¼ ê´„í˜¸ ë‘ê°œ ì¨ì•¼ ì ìš©ë¨

- @NumberFormat , @DateTimeFormat ì •ë„ë§Œ ì“°ëŠ”ê±° ê°™ê³  íŠ¹íˆ ë‚ ì§œ í¬ë§· ë§ì¶”ëŠ”ê²ƒì€ ìœ ìš©
  - ë” ìì„¸í•œ ë‚´ìš©ì€ pdfì˜ ë§í¬ ì°¸ì¡°

## ì •ë¦¬

- ì¤‘ìš” ë‚´ìš©
 - **ë©”ì‹œì§€ ì»¨ë²„í„°( HttpMessageConverter )ì—ëŠ” ì»¨ë²„ì „ ì„œë¹„ìŠ¤ê°€ ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.** ğŸ‘ ğŸ‘
   -  ì˜ˆë¥¼ ë“¤ì–´ jsonì„ ê°ì²´ë¡œ ë³€í™˜í•˜ëŠ”ê²ƒì€ ì „ì ìœ¼ë¡œ jackson libraryì— ë‹¬ë ¤ìˆìŒ. ë”°ë¼ì„œ jackson libraryê°€ ì œê³µí•˜ëŠ” ê¸°ìˆ ì„ ì¨ì„œ í¬ë§¤íŒ…ì„ í•´ì•¼í•œë‹¤. !! 
   -  > jackson data formatì„ ê²€ìƒ‰í•´ë³´ë¼ê³  í•¨
 - ì»¨ë²„ì „ ì„œë¹„ìŠ¤ëŠ” @RequestParam , @ModelAttribute , @PathVariable , ë·° í…œí”Œë¦¿ ë“±ì—ì„œ ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 


## ê¸°íƒ€ 

- argument resolver vs type converter
  - https://hashcode.co.kr/questions/2964/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8D%ED%81%AC%EC%97%90%EC%84%9C-conversion-service-%EC%99%80-argument-resolver-%EC%9D%98-%EC%B0%A8%EC%9D%B4%EB%A5%BC-%EC%95%8C%EA%B3%A0-%EC%8B%B6%EC%8A%B5%EB%8B%88%EB%8B%A4